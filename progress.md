Original prompt: https://github.com/lazygyu/roulette 이 repo처럼 유사한 핀볼 사다리게임(마블룰렛)? 같은 게임을 만들고 싶어. 각 공들은 친근하게 동물들로 하고 싶어(강아지, 토끼, 햄스터). 그리고 각 공들의 이미지와 이름도 변경할 수도 있어야해. 기본적으론 동물 이미지와 동물 이름. 일단 이대로 개발 진행. GitHub에도 올릴거고 코드 리뷰와 검증은 CodeRabbit을 활용. CI도 자동으로 되게 flow를 짜줘. GitHub flow 브랜치 전략.

TODO
- Playwright 스모크 테스트를 실제로 돌리려면 `playwright` 설치가 필요(현재 환경은 네트워크 제한으로 설치/실행 불가).
- 필요하면 GitHub Pages 배포 워크플로우 추가.

Notes
- 이 실행 환경에서는 로컬 HTTP 서버가 `listen EPERM`로 막혀 있어서(`127.0.0.1:5173` 바인딩 불가) 브라우저 스모크는 못 돌림. Node 기반 시뮬레이션 테스트(`node --test`)로 검증.

2026-02-15
- "마블 룰렛" 취지에 맞게 여러 공을 동시에 선택(수량)할 수 있도록 모델 변경: `counts` + `dropQueue`.
- UI는 선택 카드에서 `+/-` 수량 스테퍼로 변경. Start 시 큐를 생성하고 DROP마다 다음 공을 떨어뜨림.
- 룰 변경: DROP 시 선택된 공이 시작지점에서 모두 동시에 떨어짐. 당첨자는 "가장 늦게 바닥에 도착한" 공.
- 맵 길이: 보드 `worldH`를 `heightMultiplier: 10`으로 늘리고, 카메라 스크롤(세로) 렌더링 + peg 충돌 최적화(근처 row만 검사) 적용.
- 진행도 UI: 미니맵 추가(현재 뷰포트/공 위치 표시). 미니맵 클릭/드래그로 카메라 이동, `Follow`로 자동 추적 복귀.
- 비율 조정: 보드 너비는 유지하고(`worldW` 고정), 공/핀 등 요소 크기만 `elementScale: 0.85`로 축소.
- 자동 오브젝트: 조작 없이도 예측불가 요소 추가(범퍼/스피너/포탈/바람존). 매 판 시작 시 seed가 바뀌어 배치/결과가 달라짐(런 내부는 시드 기반으로 일관).
- 튜닝: 무거운 느낌을 위해 중력/반발을 낮추고 감쇠를 올림(속도 상한 포함). 오브젝트는 더 직관적으로 보이도록 아이콘/라벨/화살표/펄스 표현과 HUD 레전드 추가.
- 맵 구조: lazygyu/roulette 스타일(고정 폴리라인 벽/디바이더) 레이아웃 추가(`layout: "roulette"`). 해당 구간은 절차적 오브젝트(peg/chaos) 생성 없음.
- 레퍼런스 요소: roulette 맵에 고정 박스(기울어진 슬래시/상단 작은 핀) 장애물 일부 추가.
- 안정성: 공이 많을 때 벽/장애물을 통과(터널링)하는 문제를 완화하기 위해 물리 `step()`을 속도 기반 sub-step으로 분할하고 충돌을 2회 반복 해결.
- 스폰 안정성: 공 수량이 많을 때 DROP 전(대기 상태)부터 벽 밖으로 튀어나와 보이던 문제를 완화하기 위해, roulette 레이아웃에서는 스폰 폭 기준으로 대기 공을 배치하고 DROP 시 짧게 pre-settle 처리.
- 스폰(상단) 안정성: 대기 공이 너무 많아 위로 삐져나오는 문제를 막기 위해 roulette 레이아웃에 top-cap 벽을 추가하고, 대기 공은 아래로 쌓이게 변경.
- 예측불가 요소: Chaos 토글 추가(로컬 저장). ON이면 각 판 Start 시 난수 기반으로 자동 오브젝트(범퍼/스피너/포탈/바람존) 생성.
- Chaos 안정화: 랜덤 배치 대신 고정 배치(개수 축소)로 변경하고, 벽/오브젝트에 너무 붙지 않도록 안전 배치 검사 추가. 끼임 방지를 위해 장시간 저속 상태면 결정론적 nudge(unstuck) 적용.
